module(delink)

import(prelude)

def-external(realpath, Str Ptr -- Str +File +Mem)
def-external(remove, Str -- Int +File)

# based on https://stackoverflow.com/questions/18159662/get-real-path-of-a-symlink
def(delink!, Str -- +IO,
    0 cast realpath
    str-print-ln!
)

def (delink-main, +IO,
    1 argc < if(
        1 argv ptr@@ delink!,
        "delink takes a filename on the command-line" panic!))

target-c99("delink.c", delink-main)
